# Hardware AI

## About

This folder contains all files related to the Hardware AI subcomponent which runs on the Programmable Logic (PL) on the Ultra96. Communication with the PL is managed using AXI DMA.

## Getting Started

1. Ensure that the `pynq` Python library is installed on the Ultra96.
2. Run `./HLS_CNN/load_test.sh`. 

This loads the overlay onto the PL and sends it three 80 * 7 inputs via AXI DMA. The script then prints the outputs to standard output along with it's certainty and time taken to complete.

# Directory Files

## `.` (Current Directory)

* `test_cnn.ipynb` - A Jupyter notebook used to train a convolution neural network using data from the WISDM dataset. Weights are saved into text files in `./CNN`.
* `actual_cnn.ipynb` - A Jupyter notebook used to train a convolution neural network using collected data within `trim_util/raw_csv/`. Weights are saved into text files in `./HLS_CNN/cpp_source`.

## `/AXIS_test`

This folder contains files which are used to ensure that the AXI stream protocol on the Ultra96 is working correctly.

## `/CNN`

This folder contains the output weights of `./test_cnn.ipynb`.

## `/HLS_CNN`

* `design_1_wrapper.bit`, `.hwh` and `.tcl` - Bitstream and hardware handoff files needed to program the Ultra96's PL.
* `load.py` - A python script used to load the bitstream onto the PL and test it's output.
* `load_test.sh` - A shell script used to execute `load.py` with sudo privileges.

### `/HLS_CNN/cpp_source`

This folder contains a C++ implementation of the neural network along with its weights. The output from the Jupyter notebook `actual_cnn.ipynb` is used to verify its correctness.

### `/HLS_CNN/hls_source`

This folder contains a HLS C++ implementation of the neural network. It includes pragmas for parallelization such as pipelining, as well as data interfaces such as AXI streams.

### `/HLS_CNN/test_values`

This folder contains the weights and biases generated by running `./actual_cnn.ipynb` as well as a few randomly generated inputs with their answers. These inputs are used to verify correctness of the NN on the PL when running `./HLS_CNN/test.py`.

## `/trim_util`

This folder contains raw data used to train `./actual_cnn.ipynb`, as well as a trimming utility `trim_util.py` which can display and trim accelerometer data found in `.csv` files.

## `/WISDM_ar_v1.1`

This folder contains data from the WISDM dataset which is used to train `./test_cnn.ipynb`.
